webpackJsonp([1,4],{"+KqN":function(t,e){t.exports='<article class="reduced">\r\n  <div class="article-margin">\r\n    <h1>Quand ?</h1>\r\n    <p class="justify">\r\n      Une majorité d\'accidents sont survenus le vendredi en 2015. Également, la plupart des accidents se sont produits\r\n      durant les mois de janvier et de février.\r\n    </p>\r\n      <div class="graphics-wrapper">\r\n        <tabs>\r\n          <tab tabTitle="Vue générale">\r\n            <div class="container">\r\n              <div class="item">\r\n                <barchart *ngIf="barChartMonthConfig" [config]="barChartMonthConfig"></barchart>\r\n              </div>\r\n              <div class="item">\r\n                <barchart *ngIf="barChartDaysOfTheWeekConfig" [config]="barChartDaysOfTheWeekConfig"></barchart>\r\n              </div>\r\n            </div>\r\n          </tab>\r\n          <tab tabTitle="Vue par jours">\r\n            <heatmapday *ngIf="dailyAccidentDataset" [dataset]="dailyAccidentDataset"></heatmapday>\r\n          </tab>\r\n          <tab tabTitle="Vue par heures">\r\n            <heatmaphour *ngIf="hourlyAccidentDataset" [dataset]="hourlyAccidentDataset"></heatmaphour>\r\n          </tab>\r\n        </tabs>\r\n      </div>\r\n  </div>\r\n</article>\r\n'},"+edA":function(t,e,n){"use strict";var i=n("3j3K"),r=n("EbZC");n.d(e,"a",function(){return s});var o=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=function(){function t(){}return t.prototype.ngAfterContentInit=function(){0===this.tabs.filter(function(t){return t.active}).length&&this.selectTab(this.tabs.first)},t.prototype.selectTab=function(t){this.tabs.toArray().forEach(function(e){return e.active=e==t})},t}();o([n.i(i.ContentChildren)(r.a),a("design:type","function"==typeof(c=void 0!==i.QueryList&&i.QueryList)&&c||Object)],s.prototype,"tabs",void 0),s=o([n.i(i.Component)({selector:"tabs",template:n("u4sc"),styles:[n("fQyF")]})],s);var c},"/uoO":function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,".map-wrapper{position:absolute;top:2px;right:1px;bottom:0;left:1px}:host .toggle-buttons{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;box-sizing:border-box;width:400px;height:35px;color:#231f20;background-color:#f1f1f2;border:1px solid #404041;border-radius:4px;font-size:.85em;cursor:default;line-height:30px;-ms-flex-wrap:wrap;flex-wrap:wrap;z-index:10}:host .buttons-ra{bottom:10px;right:10px}:host .buttons-mrc{bottom:10px;left:10px}:host .toggle-buttons>.toggle-button{-webkit-box-flex:1;-ms-flex:1;flex:1;width:100%}:host .toggle-buttons>.toggle-button:not(:last-child){border-right:1px solid #404041}:host .toggle-buttons>.toggle-button.active{color:#fff;background-color:#6d6e70}",""]),t.exports=t.exports.toString()},"/v7D":function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw");n.d(e,"a",function(){return s});var o=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=function(){function t(t){this.accidentService=t}return t.prototype.ngOnInit=function(){this.initializeGraphics(),this.accidentService.onDataChanged.subscribe(this.initializeGraphics.bind(this))},t.prototype.initializeGraphics=function(){var t=this;this.accidentService.accidentsPerMonths.then(function(e){t.barChartMonthConfig={height:250,width:500,margin:{top:25,right:40,bottom:40,left:80},title:"Accidents par mois",dataset:e}}),this.accidentService.accidentsPerDaysOfTheWeek.then(function(e){t.barChartDaysOfTheWeekConfig={height:250,width:500,margin:{top:25,right:20,bottom:40,left:60},title:"Accidents par jours de la semaine",dataset:e}}),this.accidentService.hourlyAccidentsFiltered.then(function(e){t.hourlyAccidentDataset=e}),this.accidentService.dailyAccidentsFiltered.then(function(e){t.dailyAccidentDataset=e})},t}();s=o([n.i(i.Component)({selector:"when-view",template:n("+KqN"),styles:[n("O9yW")]}),a("design:paramtypes",["function"==typeof(c=void 0!==r.a&&r.a)&&c||Object])],s);var c},0:function(t,e,n){t.exports=n("x35b")},"0fTb":function(t,e){t.exports='<article>\r\n  <div id="home-container">\r\n    <img id="logo" alt="logo" src="assets/img/lys.svg">\r\n    <h1>Accidents de la route<br>survenus au Québec</h1>\r\n    <hr>\r\n    <h2>2015</h2>\r\n  </div>\r\n  <p class="reference"><a href="https://commons.wikimedia.org/wiki/File:Fleur-de-lis-fill.svg" target="_blank">Image</a> par Frater5 /\r\n    <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" target="_blank">CC BY-SA</a></p>\r\n</article>\r\n'},"17re":function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,":host .container{width:100%;height:100%}:host /deep/ #container{width:100%;height:100%;padding:50px}:host /deep/ rect.bordered{stroke:#e6e6e6;stroke-width:2px}.heatmaphour /deep/ rect.bordered{stroke-width:0}:host /deep/ .label{font-size:9pt;fill:#000}:host /deep/ svg{vertical-align:top}:host /deep/ .legend-title{font-size:11pt}",""]),t.exports=t.exports.toString()},"3KUe":function(t,e){},"3YJf":function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw"),o=n("8JD7"),a=n("Za4h");n.n(a);n.d(e,"a",function(){return l});var s=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(){function t(t,e){this.accidentService=t,this.quebecInfoService=e,this.filters={entities:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],criteria:{type:-1,gravity:-1,weather:-1,zone:-1},location:{region:-1,mrc:-1}}}return Object.defineProperty(t.prototype,"currentIndex",{set:function(t){this.visible=t>=3&&t<=5},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.regionsList=this.quebecInfoService.regions.sort(function(t,e){return a.ascending(t.name,e.name)}),this.regionsListFiltered=this.regionsList,this.quebecInfoService.mrcPopulation.then(function(e){t.mrcList=e.sort(function(t,e){return a.ascending(t.mrc,e.mrc)}),t.mrcListFiltered=t.mrcList}),this.updateCount(),this.accidentService.onDataChanged.subscribe(this.updateCount.bind(this))},t.prototype.updateCount=function(){var t=this;this.accidentService.accidentsFiltered.then(function(e){return t.accidentsCount=e.length})},t.prototype.onValueChanged=function(){var t=this;this.mrcListFiltered=this.mrcList.filter(function(e){return-1==t.filters.location.region||e.raCode==t.filters.location.region}),this.regionsListFiltered=this.regionsList.filter(function(e){return-1==t.filters.location.mrc||e.code==t.mrcList.find(function(e){return e.mrcCode==t.filters.location.mrc}).raCode}),this.accidentService.applyFilters(this.filters)},t}();s([n.i(i.Input)(),c("design:type",Number),c("design:paramtypes",[Number])],l.prototype,"currentIndex",null),l=s([n.i(i.Component)({selector:"filters-panel",template:n("Fn8W"),styles:[n("pOuB")]}),c("design:paramtypes",["function"==typeof(d=void 0!==r.a&&r.a)&&d||Object,"function"==typeof(h=void 0!==o.a&&o.a)&&h||Object])],l);var d,h},"5EPg":function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,":host .graphics-wrapper h2{position:absolute;top:30%;right:0;left:0;padding:0;margin:0;-webkit-transform:translateY(-50%);transform:translateY(-50%)}",""]),t.exports=t.exports.toString()},"5im0":function(t,e){t.exports='<div class="white-background" [hidden]="!isVisible">\r\n  <div class="loading-panel">\r\n    <img alt="chargement" src="assets/img/loading.gif"><br>\r\n    <span>Chargement...</span>\r\n  </div>\r\n</div>\r\n'},"6Jx0":function(t,e){t.exports='<article>\r\n  <img id="accident" alt="accident" src="assets/img/accident.svg">\r\n  <p>Il y a eu un total de <strong>{{ accidentsCount | numberFormatting }}</strong> accidents au Québec en 2015.</p>\r\n  <p><strong>{{ fatalAccidentsCount | numberFormatting }}</strong> d\'entre-eux ont été mortels.</p>\r\n  <p><strong>{{ deadCount | numberFormatting }}</strong> personnes sont décédées.</p>\r\n  <p class="reference">\r\n    Image par <a href="http://www.freepik.com" title="Freepik" target="_blank">Freepik</a> de\r\n    <a href="http://www.flaticon.com" title="Flaticon" target="_blank">flaticon</a> /\r\n    <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a>\r\n  </p>\r\n</article>\r\n'},"6jYp":function(t,e,n){"use strict";var i=n("3j3K"),r=n("ErHN"),o=n("3KUe"),a=(n.n(o),n("l6W8")),s=n("Za4h"),c=(n.n(s),n("8hZP")),l=(n.n(c),n("M4fF")),d=(n.n(l),n("mdqA")),h=(n.n(d),n("nrd6"));n.n(h);n.d(e,"a",function(){return p});var u=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},f=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=g=function(){function t(){this.isInitialized=!1}return t.linkD3toLeaflet=function(t){var e=s.select(t.getPanes().overlayPane).append("svg");return[e,e.append("g").attr("class","leaflet-zoom-hide")]},t.positionSVG=function(t,e,n,i){var r=n.bounds(i),o=r[0],a=r[1];return t.attr("width",a[0]-o[0]).attr("height",a[1]-o[1]).style("left",o[0]+"px").style("top",o[1]+"px"),e.attr("transform","translate("+-o[0]+","+-o[1]+")"),r},t.featuresUpdate=function(t,e){t.attr("d",e)},t.normalizeName=function(t){return t.replace(/\s+/g,"").replace(/\.|\'/g,"").toLowerCase()},t.setLegendText=function(t,e){t.style("opacity",0).text(e).transition().duration(1e3).style("opacity",1)},t.prototype.ngOnInit=function(){var t=this.config.dataset;this.mrcList=l(t).map(function(t){return t.name}).uniq().value();var e=s.select(this.element.nativeElement);e.attr("id","map").style({width:"100%",height:"100%"});var n=this.linkDivToLeaflet("http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"),i=g.linkD3toLeaflet(n),r=i[0],o=i[1],h=l.tail(d.Reds[9]),u=s.scale.quantile().domain(l(t).map(function(t){return t.totalAccidents}).sort().value()).range(h),f=this.createPath(n),p=e.select("svg g").append("g").attr("id","quebecmrc").selectAll("path").data(this.json.features).enter().append("path").attr({class:function(e){var n=l.find(t,function(t){return t.code===+e.properties.MRS_CO_MRC});return g.normalizeName(n.name)+" mrc"},d:f,fill:function(e){var n=l.find(t,function(t){return t.code===+e.properties.MRS_CO_MRC}).totalAccidents;return u(n?n:0)},opacity:.8,stroke:"black","stroke-width":1,"stroke-opacity":.2,"data-mrc":function(e){var n=l.find(t,function(t){return t.code===+e.properties.MRS_CO_MRC});return JSON.stringify(n)}}),m=c().attr("class","d3-tip").offset([-10,0]).html(function(){var t=s.select(this),e=JSON.parse(t.attr("data-mrc"));return"MRC : "+e.name+"<br>Nombre d'accidents : "+e.totalAccidents+"<br>Nombre d'habitants : "+e.population});p.on("mouseover",function(t){a.a.call(this,t,m)}).on("mouseout",m.hide),r.call(m);var v=function(t,e,n,i,r){var o=g.positionSVG,a=g.featuresUpdate;return function(){o(t,e,n,r),a(i,n)}};n.on("zoom",v(r,o,f,p,this.json)),v(r,o,f,p,this.json)(),this.createMapLegend(u,"Nombre d'accidents"),this.isInitialized=!0},t.prototype.ngOnChanges=function(){if(this.json&&this.config&&this.isInitialized){var t=this.config.dataset,e="",i=[];"absolute"===this.config.view?(e="Nombre d'accidents",i=l(t).map(function(t){return t.totalAccidents}).sortBy().value()):"relative"===this.config.view&&(e="Nombre d'accidents par 10 000 habitants",i=l(t).map(function(t){return 1e4*t.totalAccidents/t.population}).sortBy().value());var o=l.tail(d.Reds[9]),a=s.scale.quantile().domain(i).range(o);this.updateMap(t,a,this.config.view);var c=s.select("#svgLegend .gLegend");n.i(r.f)(c,a),g.setLegendText(c.select("text"),e)}},t.prototype.linkDivToLeaflet=function(t){var e="Tiles courtesy of <a href='http://openstreetmap.se/=' target='_blank'>OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>",n=new h.LatLngBounds(new h.LatLng(42,-85),new h.LatLng(60,-50)),i=h.tileLayer(t,{attribution:e,maxZoom:7,minZoom:4,reset:!1}),r=new h.Map("map",{zoom:4.5,center:n.getCenter(),layers:[i],maxBounds:n,maxBoundsViscosity:.75});return setTimeout(function(){r.invalidateSize(),r.fitBounds(n)},300),r},t.prototype.searchNameChanged=function(){var t=g.normalizeName(this.searchName);t&&(this.currentSelection&&this.currentSelection.attr({stroke:"black","stroke-width":1,"stroke-opacity":.2}),this.currentSelection=s.select(this.element.nativeElement.querySelector("."+t)),this.currentSelection.attr({stroke:"black","stroke-width":6,"stroke-opacity":.8}))},t.prototype.createPath=function(t){var e=s.geo.transform({point:this.projectPoint(t)});return s.geo.path().projection(e)},t.prototype.projectPoint=function(t){return function(e,n){var i=t.latLngToLayerPoint(new h.LatLng(n,e));this.stream.point(i.x,i.y)}},t.prototype.createMapLegend=function(t,e){var i={top:30,right:0,bottom:10,left:0},o={width:55,height:15},a=o.width*(t.quantiles().length+1),c=4*o.height,l=s.select(this.element.nativeElement.parentNode).select(".map").append("svg").attr({id:"svgLegend",width:a+i.left+i.right,height:c+i.top+i.bottom}).append("g").attr("transform","translate("+i.left+","+i.top+")");n.i(r.d)(l,e,t,o)},t.prototype.updateMap=function(t,e,n){s.selectAll("#quebecmrc path").attr({"data-mrc":function(e){var n=l.find(t,function(t){return t.code===+e.properties.MRS_CO_MRC});return JSON.stringify(n)}}).transition().duration(1e3).attr({fill:function(i){var r=l.find(t,function(t){return t.code===+i.properties.MRS_CO_MRC}),o=0;return"absolute"===n?o=r.totalAccidents:"relative"===n&&(o=1e4*r.totalAccidents/r.population),e(o?o:0)}})},t}();u([n.i(i.ViewChild)("map"),f("design:type","function"==typeof(m=void 0!==i.ElementRef&&i.ElementRef)&&m||Object)],p.prototype,"element",void 0),u([n.i(i.Input)(),f("design:type",Object)],p.prototype,"json",void 0),u([n.i(i.Input)(),f("design:type","function"==typeof(v=void 0!==o.GeoMapConfig&&o.GeoMapConfig)&&v||Object)],p.prototype,"config",void 0),u([n.i(i.Input)(),f("design:type",String)],p.prototype,"searchText",void 0),p=g=u([n.i(i.Component)({selector:"geomap",template:n("TsxO"),styles:[n("Gr9x")]})],p);var g,m,v},7185:function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw"),o=n("M4fF");n.n(o);n.d(e,"a",function(){return c});var a=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},c=function(){function t(t){this.accidentService=t,this.isDatasetEmpty=!0}return t.prototype.ngOnInit=function(){this.initializeGraphics(),this.accidentService.onDataChanged.subscribe(this.initializeGraphics.bind(this))},t.prototype.initializeGraphics=function(){var t=this;this.accidentService.accidentsByEntityFiltered.then(function(e){console.log(e),t.entitiesAccidentDataset=e,t.isDatasetEmpty=!o.some(e,function(t){return t.totalAccidents>0})}),this.accidentService.accidentsFiltered.then(function(e){return t.accidentsCount=e.length})},t}();c=a([n.i(i.Component)({selector:"who-view",template:n("n+f3"),styles:[n("5EPg")]}),s("design:paramtypes",["function"==typeof(l=void 0!==r.a&&r.a)&&l||Object])],c);var l},"8JD7":function(t,e,n){"use strict";var i=n("3j3K"),r=n("Fzro"),o=n("eErF"),a=(n.n(o),n("Za4h"));n.n(a);n.d(e,"a",function(){return l});var s=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(){function t(t){this.http=t,this.regions=[{code:1,name:"Bas-Saint-Laurent"},{code:2,name:"Saguenay–Lac-Saint-Jean"},{code:3,name:"Capitale-Nationale"},{code:4,name:"Mauricie"},{code:5,name:"Estrie"},{code:6,name:"Montréal"},{code:7,name:"Outaouais"},{code:8,name:"Abitibi-Témiscamingue"},{code:9,name:"Côte-Nord"},{code:10,name:"Nord-du-Québec"},{code:11,name:"Gaspésie–Îles-de-la-Madeleine"},{code:12,name:"Chaudière-Appalaches"},{code:13,name:"Laval"},{code:14,name:"Lanaudière"},{code:15,name:"Laurentides"},{code:16,name:"Montérégie"},{code:17,name:"Centre-du-Québec"}],this.mrcPopulation=this.loadMRCPopulationData()}return t.prototype.loadMRCPopulationData=function(){return this.http.get("assets/data/population_mrc.csv").toPromise().then(function(t){var e=t.text();return a.csv.parse(e,function(t){return{mrcCode:+t.CodeMRC,mrc:t.MRC,raCode:+t.RA,population2015:+t.Population2015}})})},t}();l=s([n.i(i.Injectable)(),c("design:paramtypes",["function"==typeof(d=void 0!==r.Http&&r.Http)&&d||Object])],l);var d},"999t":function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw");n.d(e,"a",function(){return s});var o=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=function(){function t(t){this.accidentService=t}return t.prototype.ngOnInit=function(){var t=this;this.isVisible=!0,this.accidentService.onDataLoaded.subscribe(function(e){t.isVisible=!1})},t}();s=o([n.i(i.Component)({selector:"loading-view",template:n("5im0")}),a("design:paramtypes",["function"==typeof(c=void 0!==r.a&&r.a)&&c||Object])],s);var c},"9pj6":function(t,e,n){"use strict";function i(t){var e=o.min(t,function(t){return t.val}),n=o.max(t,function(t){return t.val});1==n&&(n=1);var i=r.Reds[9];return o.scale.quantile().domain([e,i.length-1,n]).range(i)}var r=n("mdqA"),o=(n.n(r),n("Za4h"));n.n(o);e.a=i},ACSc:function(t,e,n){"use strict";var i=n("3j3K");n.d(e,"a",function(){return o});var r=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},o=function(){function t(){}return t.prototype.transform=function(t){return new Intl.NumberFormat("fr-CA").format(t)},t}();o=r([n.i(i.Pipe)({name:"numberFormatting"})],o)},EbZC:function(t,e,n){"use strict";var i=n("3j3K");n.d(e,"a",function(){return a});var r=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},o=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=function(){function t(){this.active=!1}return t}();r([n.i(i.Input)("tabTitle"),o("design:type",String)],a.prototype,"title",void 0),r([n.i(i.Input)(),o("design:type",Object)],a.prototype,"active",void 0),a=r([n.i(i.Component)({selector:"tab",styles:["\n    .pane{\n      height: 100%;\n    }\n  "],template:'\n    <div [hidden]="!active" class="pane">\n      <ng-content></ng-content>\n    </div>\n  '})],a)},Ekwi:function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,":host h1{position:absolute;top:50%;right:0;left:0;padding:0;margin:0;text-align:center;font-size:3.7em;-webkit-transform:translateY(-50%);transform:translateY(-50%)}:host h2{font-size:1.1em}:host .title-wrapper{position:absolute;top:0;left:0;bottom:250px;width:100%}:host .credits-wrapper{position:absolute;bottom:0;left:0;box-sizing:border-box;width:100%;height:250px;padding:20px 40px;background-color:#eee;z-index:1000}",""]),t.exports=t.exports.toString()},ErHN:function(t,e,n){"use strict";function i(t,e,n,i){var o=t.append("svg"),a=o.append("g");return r(o,e,n,i),[o,a]}function r(t,e,n,i){return t.attr({width:"100%",height:"100%",viewBox:"0 0 "+(e+i.left+i.right)+" "+(n+i.top+i.bottom)}).select("g").attr("transform","translate("+i.left+","+i.top+")")}function o(t,e,n,i){var r=t.selectAll(".card").data(e);return r.enter().append("rect").attr({x:function(t){return t.row*n.x},y:function(t){return t.col*n.y},rx:4,ry:4,class:"card bordered",width:n.x,height:n.y}).style("fill",i(0)),r.transition().duration(1e3).style("fill",function(t){return i(t.val)}),r.exit().remove(),r}function a(t,e,n,i){var r=n.quantiles().length,o=t.append("g").attr("class","gLegend");o.append("text").text(e).attr({x:i.width*r/2,y:0,class:"legend-title"}).style("text-anchor","middle");var a=o.selectAll(".legend").data([0].concat(n.quantiles())).enter().append("g").attr("class","legend");return a.append("rect").attr({x:function(t,e){return i.width*e},y:i.height,width:i.width,height:i.height}),a.append("text").attr({x:function(t,e){return i.width*e+i.width/2},y:2*i.height+15,class:"label"}).style("text-anchor","middle"),s(o,n),o}function s(t,e){var n=t.selectAll(".legend").data([0].concat(e.quantiles()));n.select("rect").attr("fill",function(t){return e(t)}),n.select("text").text(function(t){return"≥ "+Math.round(t)})}function c(t,e,n){t.append("text").text(n).style({"text-anchor":"middle","text-transform":"capitalize","font-weight":"bold"}).attr({x:0,y:0,transform:"translate("+e/2+", -6)",class:"label"})}e.a=i,e.e=r,e.c=o,e.d=a,e.f=s,e.b=c},Fn8W:function(t,e){t.exports='<form [class.visible]="visible">\r\n  <h1>{{ accidentsCount | numberFormatting }} <small>accident<span *ngIf="accidentsCount > 1">s</span></small></h1>\r\n  <fieldset>\r\n    <legend>Entités impliquées</legend>\r\n\r\n    <input type="checkbox" name="bus-checkbox" id="bus-checkbox"\r\n           [(ngModel)]="filters.entities[1]" (ngModelChange)="onValueChanged()">\r\n    <label for="bus-checkbox">Autobus</label><br>\r\n\r\n    <input type="checkbox" name="car-checkbox" id="car-checkbox"\r\n           [(ngModel)]="filters.entities[2]" (ngModelChange)="onValueChanged()">\r\n    <label for="car-checkbox">Automobile</label><br>\r\n\r\n    <input type="checkbox" name="truck-checkbox" id="truck-checkbox"\r\n           [(ngModel)]="filters.entities[8]" (ngModelChange)="onValueChanged()">\r\n    <label for="truck-checkbox">Camion</label><br>\r\n\r\n    <input type="checkbox" name="motorbike-checkbox" id="motorbike-checkbox"\r\n           [(ngModel)]="filters.entities[4]" (ngModelChange)="onValueChanged()">\r\n    <label for="motorbike-checkbox">Moto</label><br>\r\n\r\n    <input type="checkbox" name="pedestrian-checkbox" id="pedestrian-checkbox"\r\n           [(ngModel)]="filters.entities[5]" (ngModelChange)="onValueChanged()">\r\n    <label for="pedestrian-checkbox">Piéton</label><br>\r\n\r\n    <input type="checkbox" name="taxi-checkbox" id="taxi-checkbox"\r\n           [(ngModel)]="filters.entities[7]" (ngModelChange)="onValueChanged()">\r\n    <label for="taxi-checkbox">Taxi</label><br>\r\n\r\n    <input type="checkbox" name="emergency-checkbox" id="emergency-checkbox"\r\n           [(ngModel)]="filters.entities[3]" (ngModelChange)="onValueChanged()">\r\n    <label for="emergency-checkbox">Véhicule d\'urgence</label><br>\r\n\r\n    <input type="checkbox" name="rv-checkbox" id="rv-checkbox"\r\n           [(ngModel)]="filters.entities[6]" (ngModelChange)="onValueChanged()">\r\n    <label for="rv-checkbox">Véhicule récréatif</label><br>\r\n\r\n    <input type="checkbox" name="bicycle-checkbox" id="bicycle-checkbox"\r\n           [(ngModel)]="filters.entities[0]" (ngModelChange)="onValueChanged()">\r\n    <label for="bicycle-checkbox">Vélo</label><br>\r\n\r\n    <input type="checkbox" name="others-checkbox" id="others-checkbox"\r\n           [(ngModel)]="filters.entities[9]" (ngModelChange)="onValueChanged()">\r\n    <label for="others-checkbox">Autres</label><br>\r\n  </fieldset>\r\n  <fieldset>\r\n    <legend>Critères</legend>\r\n\r\n    <label for="type-choices">Genre</label>\r\n    <select name="type-choices" id="type-choices" [(ngModel)]="filters.criteria.type" (ngModelChange)="onValueChanged()">\r\n      <option value="-1">Tous</option>\r\n      <option value="4">Collision avec animaux</option>\r\n      <option value="2">Collision avec cycliste</option>\r\n      <option value="5">Collision avec objet fixe</option>\r\n      <option value="1">Collision avec piéton</option>\r\n      <option value="3">Collision avec train</option>\r\n      <option value="0">Collision avec véhicule routier</option>\r\n      <option value="6">Sans collision</option>\r\n      <option value="7">Autres</option>\r\n    </select><br>\r\n\r\n    <label for="gravity-choices">Gravité</label>\r\n    <select name="gravity-choices" id="gravity-choices" [(ngModel)]="filters.criteria.gravity" (ngModelChange)="onValueChanged()">\r\n      <option value="-1">Tous</option>\r\n      <option value="0">Dommages matériels seulement</option>\r\n      <option value="1">Léger</option>\r\n      <option value="2">Grave</option>\r\n      <option value="3">Mortel</option>\r\n    </select><br>\r\n\r\n    <label for="weather-choices">Météo</label>\r\n    <select name="weather-choices" id="weather-choices" [(ngModel)]="filters.criteria.weather" (ngModelChange)="onValueChanged()">\r\n      <option value="-1">Tous</option>\r\n      <option value="15">Averse (pluie forte)</option>\r\n      <option value="13">Brouillard</option>\r\n      <option value="11">Clair</option>\r\n      <option value="17">Neige / grêle</option>\r\n      <option value="12">Nuageux</option>\r\n      <option value="14">Pluie / bruine</option>\r\n      <option value="18">Poudrerie / tempête de neige</option>\r\n      <option value="16">Vent fort</option>\r\n      <option value="19">Verglas</option>\r\n      <option value="99">Autres</option>\r\n    </select><br>\r\n\r\n    <label for="zone-choices">Secteur</label>\r\n    <select name="zone-choices" id="zone-choices" [(ngModel)]="filters.criteria.zone" (ngModelChange)="onValueChanged()">\r\n      <option value="-1">Tous</option>\r\n      <option value="1">Scolaire</option>\r\n      <option value="2">Résidentiel</option>\r\n      <option value="3">Affaires / commercial</option>\r\n      <option value="4">Industriel / manufacturier</option>\r\n      <option value="5">Rural</option>\r\n      <option value="6">Forestier</option>\r\n      <option value="7">Récréatif / parc / camping</option>\r\n      <option value="9">Autres</option>\r\n    </select>\r\n  </fieldset>\r\n  <fieldset>\r\n    <legend>Localisation</legend>\r\n\r\n    <label for="region-choices">Région</label>\r\n    <select name="region-choices" id="region-choices" [(ngModel)]="filters.location.region" (ngModelChange)="onValueChanged()">\r\n      <option value="-1">Toutes</option>\r\n      <option *ngFor="let region of regionsListFiltered" [value]="region.code">{{ region.name }}</option>\r\n    </select><br>\r\n\r\n    <label for="mrc-choices">MRC</label>\r\n    <select name="mrc-choices" id="mrc-choices" [(ngModel)]="filters.location.mrc" (ngModelChange)="onValueChanged()">\r\n      <option value="-1">Toutes</option>\r\n      <option *ngFor="let item of mrcListFiltered" [value]="item.mrcCode">{{ item.mrc }}</option>\r\n    </select>\r\n  </fieldset>\r\n</form>\r\n'},Gr9x:function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,":host #container{position:relative;width:100%;height:100%}:host #search-bar{position:relative;padding:5px 10px;border:1px solid #404041;border-radius:5px;font-family:Open Sans,sans-serif;z-index:10}:host #bTotal{position:absolute;top:40px;right:100px;z-index:10}:host #bRelative{position:absolute;top:70px;right:65px;z-index:10}:host /deep/ #svgLegend{position:absolute;right:15px;bottom:10px;font-family:Open Sans,sans-serif;z-index:10}:host /deep/ .background{fill:none;pointer-events:all}:host .toggle-buttons{position:absolute;bottom:10px;left:10px;display:-webkit-box;display:-ms-flexbox;display:flex;box-sizing:border-box;width:400px;height:40px;color:#231f20;background-color:#f1f1f2;border:1px solid #404041;border-radius:4px;font-size:.85em;cursor:default;line-height:38px;-ms-flex-wrap:wrap;flex-wrap:wrap;z-index:10}:host .toggle-buttons>.toggle-button{-webkit-box-flex:1;-ms-flex:1;flex:1;width:100%}:host .toggle-buttons>.toggle-button:not(:last-child){border-right:1px solid #404041}:host .toggle-buttons>.toggle-button.active{color:#fff;background-color:#6d6e70}:host .auto-complete-wrapper{position:absolute;top:10px;bottom:10px;right:10px;z-index:10000;text-align:left;overflow:hidden}ng2-auto-complete ul{height:50px;overflow:auto}",""]),t.exports=t.exports.toString()},H1TT:function(t,e,n){"use strict";var i=n("3j3K"),r=n("Fzro"),o=n("eErF"),a=(n.n(o),n("eiri"));n.n(a);n.d(e,"a",function(){return l});var s=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(){function t(t){this.http=t,this.mrcJson=this.loadQuebecMap()}return t.prototype.loadQuebecMap=function(){return this.http.get("assets/data/mrc_poly.json").toPromise().then(function(t){var e=t.json();return a.feature(e,e.objects.mrc_poly)})},t}();l=s([n.i(i.Injectable)(),c("design:paramtypes",["function"==typeof(d=void 0!==r.Http&&r.Http)&&d||Object])],l);var d},Iksp:function(t,e,n){"use strict";var i=n("3j3K"),r=n("Qbdm"),o=n("Fzro"),a=n("NVOs"),s=n("0fHH"),c=(n.n(s),n("YWx4")),l=n("i+t5"),d=n("LqA9"),h=n("Ry3Z"),u=n("6jYp"),f=n("imtw"),p=n("8JD7"),g=n("H1TT"),m=n("Tlry"),v=n("Ybm7"),b=n("jTNU"),y=n("X3MM"),x=n("pXPn"),w=n("xC+v"),C=n("/v7D"),M=n("3YJf"),R=n("tXfc"),A=n("7185"),O=n("+edA"),j=n("EbZC"),S=n("999t"),_=n("ACSc"),k=n("nUGs"),D=n("hMt2");n.n(D);n.d(e,"a",function(){return P});var z=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},P=function(){function t(){}return t}();P=z([n.i(i.NgModule)({imports:[r.a,a.FormsModule,o.HttpModule,b.a.forRoot(),D.Ng2AutoCompleteModule],declarations:[c.a,l.a,M.a,k.a,u.a,d.a,h.a,m.a,x.a,v.a,S.a,s.MnFullpageDirective,y.a,_.a,w.a,j.a,O.a,C.a,R.a,A.a],providers:[f.a,p.a,g.a,s.MnFullpageService],bootstrap:[c.a],schemas:[i.NO_ERRORS_SCHEMA]})],P)},LqA9:function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw"),o=n("ErHN"),a=n("9pj6"),s=n("Za4h"),c=(n.n(s),n("8hZP")),l=(n.n(c),n("M4fF")),d=(n.n(l),n("l6W8"));n.d(e,"a",function(){return g});var h=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=7,p=6,g=m=function(){function t(){var t=this;this.legendSize={width:80,height:20},this.cardSize={x:30,y:15},this.nbMonthsPerRow=4,this.hmMargin={top:20,right:20,bottom:20,left:25},this.hmSvgWidth=this.cardSize.x*f+this.hmMargin.left+this.hmMargin.right,this.hmSvgHeight=this.cardSize.y*p+this.hmMargin.top+this.hmMargin.bottom,this.svgWidth=this.hmSvgWidth*this.nbMonthsPerRow,this.isInitialized=!1,this.getMonthDataset=function(e){var n=l.filter(t.dataset,function(t){return t.month===e}),i=l(n).sortBy("day").head();return l(n).map(function(t){return{month:e,day:t.day,row:t.weekday,col:Math.floor((t.day-1+i.weekday)/f),val:t.val}}).value()}}return t.getMonthLabel=function(t){return new Date(2015,t).toLocaleString("fr",{month:"long"})},t.prototype.ngOnInit=function(){var t=this,e=s.select(this.element.nativeElement),i=n.i(a.a)(this.dataset),c={top:20,right:0,bottom:30,left:0},l=this.hmSvgWidth*this.nbMonthsPerRow,d=this.hmSvgHeight*Math.ceil(r.b.length/this.nbMonthsPerRow)+2*this.legendSize.height+30,h=n.i(o.a)(e,l,d,c),u=(h[0],h[1]),f=u.selectAll(".dayheatmap").data(r.b).enter().append("g").attr({class:"dayheatmap",width:this.hmSvgWidth,height:function(e){return t.hmSvgHeight},transform:function(e){return"translate("+e%t.nbMonthsPerRow*t.hmSvgWidth+","+t.hmSvgHeight*Math.floor(e/t.nbMonthsPerRow)+")"}}).append("g").attr("transform","translate("+this.hmMargin.left+","+this.hmMargin.top+")");n.i(o.b)(f,this.hmSvgWidth-this.hmMargin.left-this.hmMargin.right,m.getMonthLabel);var p=n.i(o.c)(f,this.getMonthDataset,this.cardSize,i);p.attr({transform:"translate(0, 5)",class:"card bordered"});var g=n.i(o.d)(u,"Nombre d'accidents",i,this.legendSize),v=this.legendSize.width*i.quantiles().length;g.attr("transform","translate("+(this.svgWidth/2-v/2)+", "+(this.hmSvgHeight*Math.ceil(r.b.length/this.nbMonthsPerRow)+30)+")"),this.updateHeatMapTip(u,p),this.isInitialized=!0},t.prototype.ngOnChanges=function(){if((this.dataset||0!=this.dataset.length)&&this.isInitialized){var t=s.select(this.element.nativeElement),e=n.i(a.a)(this.dataset),i=s.selectAll(".dayheatmap > g"),c=i.selectAll(".card").data(this.getMonthDataset).style("fill",function(t){return e(0)});c.transition().duration(1e3).style("fill",function(t){return e(t.val)}),this.updateHeatMapTip(t.select("svg"),c);var l=t.select(".gLegend");n.i(o.f)(l,e);var d=this.legendSize.width*e.quantiles().length,h=this.svgWidth/2-d/2,u=this.hmSvgHeight*Math.ceil(r.b.length/this.nbMonthsPerRow)+30;l.attr("transform","translate("+h+", "+u+")")}},t.prototype.updateHeatMapTip=function(t,e){s.selectAll(".dayheatmaptip").remove();var n=c().attr("class","d3-tip dayheatmaptip").offset([-10,0]).html(function(t){return"Date : "+r.c[t.row]+" le "+t.day+" "+m.getMonthLabel(t.month)+" 2015<br>Nombre d'accidents : "+t.val});e.on("mouseover",function(t){d.a.call(this,t,n)}).on("mouseout",n.hide),t.call(n)},t}();h([n.i(i.ViewChild)("container"),u("design:type","function"==typeof(v=void 0!==i.ElementRef&&i.ElementRef)&&v||Object)],g.prototype,"element",void 0),h([n.i(i.Input)(),u("design:type",Array)],g.prototype,"dataset",void 0),g=m=h([n.i(i.Component)({selector:"heatmapday",template:'\n    <div #container class="container"></div>\n  ',styles:[n("17re")]})],g);var m,v},MOVZ:function(t,e){function n(t){throw new Error("Cannot find module '"+t+"'.")}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="MOVZ"},O9yW:function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,".container{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;height:100%;text-align:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.container>.item{position:relative;height:inherit;-ms-flex-preferred-size:50%;flex-basis:50%}.container>.item>h2{margin-top:30px;margin-bottom:5px;font-size:.95em}",""]),t.exports=t.exports.toString()},OzaX:function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,":host{text-align:center}h1{margin-top:10px;font-size:3.2em}h1,h2{color:#404041;font-family:Alegreya,serif;font-weight:400}h2{font-size:2.5em}hr{border-color:#404041;width:150px}#logo{height:150px}#home-container{position:absolute;top:50%;left:0;width:100%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}",""]),t.exports=t.exports.toString()},P2ad:function(t,e){t.exports='<article>\r\n  <div class="title-wrapper">\r\n    <h1>Soyez prudent!</h1>\r\n  </div>\r\n  <div class="credits-wrapper">\r\n    <h2>Programmeurs</h2>\r\n    <ul>\r\n      <li>Antoine Béland</li>\r\n      <li>Konstantinos Lambrou-Latreille</li>\r\n    </ul>\r\n    <h2>Sources</h2>\r\n    <ul>\r\n      <li><a href="https://www.donneesquebec.ca/recherche/fr/dataset/rapports-d-accident/resource/5e970115-19f7-4dc7-8a20-13252b4ac5a1" target="_blank">Rapports d\'accident pour l\'année 2015</a></li>\r\n      <li><a href="http://www.stat.gouv.qc.ca/statistiques/population-demographie/structure/mrc_total.htm" target="_blank">Population des régions et des MRC du Québec</a></li>\r\n    </ul>\r\n  </div>\r\n</article>\r\n'},Ry3Z:function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw"),o=n("ErHN"),a=n("9pj6"),s=n("Za4h"),c=(n.n(s),n("8hZP")),l=(n.n(c),n("M4fF")),d=(n.n(l),n("l6W8"));n.d(e,"a",function(){return p});var h=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=31,p=g=function(){function t(){var t=this;this.legendSize={width:80,height:20},this.cardSize={x:5,y:5},this.nbMonthsPerRow=6,this.hmMargin={top:20,right:20,bottom:20,left:25},this.svgMargin={top:20,right:0,bottom:20,left:0},this.isInitialized=!1,this.getMonthDataset=function(e){return l(t.dataset).filter(function(t){return t.month===e}).map(function(t){return{month:e,row:t.hour,col:t.day-1,val:t.val}}).value()}}return t.getMonthLabel=function(t){return new Date(2015,t).toLocaleString("fr",{month:"long"})},t.prototype.ngOnInit=function(){var t=this,e=s.select(this.element.nativeElement),i=n.i(a.a)(this.dataset),c=this.cardSize.x*this.getHoursPerDay().length+this.hmMargin.left+this.hmMargin.right,l=this.cardSize.y*f+this.hmMargin.top+this.hmMargin.bottom,d=c*this.nbMonthsPerRow,h={top:20,right:0,bottom:30,left:0},u=c*this.nbMonthsPerRow,p=l*Math.ceil(r.b.length/this.nbMonthsPerRow)+2*this.legendSize.height+30,m=n.i(o.a)(e,u,p,h),v=(m[0],m[1]),b=v.selectAll("g").data(r.b).enter().append("g").attr({class:"hourheatmap",width:c,height:l,transform:function(e){return"translate("+e%t.nbMonthsPerRow*c+","+l*Math.floor(e/t.nbMonthsPerRow)+")"}}).append("g").attr("transform","translate("+this.hmMargin.left+","+this.hmMargin.top+")");n.i(o.b)(b,c-this.hmMargin.left-this.hmMargin.bottom,g.getMonthLabel);var y=n.i(o.c)(b,this.getMonthDataset,this.cardSize,i);y.attr({transform:"translate(0, 5)",class:"card bordered"});var x=n.i(o.d)(v,"Nombre d'accidents",i,this.legendSize),w=this.legendSize.width*i.quantiles().length;x.attr("transform","translate("+(d/2-w/2)+", "+(l*Math.ceil(r.b.length/this.nbMonthsPerRow)+30)+")"),this.updateHeatMapTip(v,y),this.isInitialized=!0},t.prototype.ngOnChanges=function(){if((this.dataset||0!=this.dataset.length)&&this.isInitialized){var t=s.select(this.element.nativeElement),e=this.cardSize.x*this.getHoursPerDay().length+this.hmMargin.left+this.hmMargin.right,i=this.cardSize.y*f+this.hmMargin.top+this.hmMargin.bottom,c=e*this.nbMonthsPerRow,l=i*Math.ceil(r.b.length/this.nbMonthsPerRow)+2*this.legendSize.height+30;n.i(o.e)(t.select("svg"),c,l,this.svgMargin);var d=n.i(a.a)(this.dataset);s.selectAll(".hourheatmap > g").selectAll(".card").data(this.getMonthDataset).style("fill",function(t){return d(0)}).transition().duration(1e3).style("fill",function(t){return d(t.val)});var h=t.select(".gLegend");n.i(o.f)(h,d);var u=this.legendSize.width*d.quantiles().length,p=c/2-u/2,g=i*Math.ceil(r.b.length/this.nbMonthsPerRow)+30;h.attr("transform","translate("+p+", "+g+")")}},t.prototype.updateHeatMapTip=function(t,e){var n=c().attr("class","d3-tip").offset([-10,0]).html(function(t){return"Date : "+r.c[new Date(2015,t.month,t.col+1).getDay()]+" le "+(t.col+1)+" "+g.getMonthLabel(t.month)+" 2015 à "+t.row+"h<br>Nombre d'accidents : "+t.val});e.on("mouseover",function(t){d.a.call(this,t,n)}).on("mouseout",n.hide),t.call(n)},t.prototype.getHoursPerDay=function(){var t=s.format("02d"),e=l.range(24);return l.map(e,function(e){return t(e)+"h"})},t}();h([n.i(i.ViewChild)("container"),u("design:type","function"==typeof(m=void 0!==i.ElementRef&&i.ElementRef)&&m||Object)],p.prototype,"element",void 0),h([n.i(i.Input)(),u("design:type",Object)],p.prototype,"dataset",void 0),p=g=h([n.i(i.Component)({selector:"heatmaphour",template:"\n    <div #container class='container heatmaphour'></div>\n  ",styles:[n("17re")]})],p);var g,m},Tlry:function(t,e,n){"use strict";var i=n("3j3K"),r=n("Za4h"),o=(n.n(r),n("8hZP")),a=(n.n(o),n("rJzN")),s=(n.n(a),n("l6W8"));n.d(e,"a",function(){return d});var c=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d=function(){function t(){this.isInitialized=!1}return t.prototype.ngOnInit=function(){var t=this,e=this.config.margin,n=this.config.height-e.top-e.bottom;this.width=this.config.width-e.left-e.right,this.g=r.select(this.element.nativeElement).append("svg").attr({class:"barchart",width:"100%",height:"100%",viewBox:"0 0 "+(this.width+e.left+e.right)+" "+(n+e.top+e.bottom)}).append("g").attr("transform","translate("+e.left+","+e.top+")"),this.xScale=r.scale.ordinal().rangeRoundBands([0,n],.15),this.yScale=r.scale.linear().range([0,this.width]),this.xAxis=r.svg.axis().scale(this.xScale).orient("left"),this.yAxis=r.svg.axis().scale(this.yScale).orient("bottom").tickFormat(r.format("d")),this.updateDomains();var i=o().attr("class","d3-tip").direction("e").offset([0,10]).html(function(t){return t.value});this.g.call(i),this.g.append("g").attr("class","x axis").call(this.xAxis).selectAll("text").data(this.config.dataset).text(function(t){return t.label}),this.g.append("g").attr("class","y axis").attr("transform","translate(0,"+n+")").call(this.yAxis),this.g.selectAll("rect").data(this.config.dataset).enter().append("rect").attr({class:"bar",x:function(t){return 0},y:function(e){return t.xScale(e.id)},height:this.xScale.rangeBand(),width:function(e){return t.yScale(e.value)}}).on("mouseover",function(t){s.a.call(this,t,i)}).on("mouseout",i.hide),this.isInitialized=!0},t.prototype.ngOnChanges=function(){var t=this;if(this.isInitialized){var e=1e3;this.updateDomains(),this.g.select(".y.axis").transition().duration(e).call(this.yAxis),this.g.selectAll("rect").data(this.config.dataset).transition().duration(e).attr("width",function(e){return t.yScale(e.value)})}},t.prototype.updateDomains=function(){this.xScale.domain(this.config.dataset.map(function(t){return t.id})),this.yScale.domain([0,r.max(this.config.dataset,function(t){return t.value})])},t}();c([n.i(i.ViewChild)("container"),l("design:type","function"==typeof(h=void 0!==i.ElementRef&&i.ElementRef)&&h||Object)],d.prototype,"element",void 0),c([n.i(i.Input)(),l("design:type","function"==typeof(u=void 0!==a.BarChartConfig&&a.BarChartConfig)&&u||Object)],d.prototype,"config",void 0),d=c([n.i(i.Component)({selector:"horizontal-barchart",template:"\n    <div #container class='container'></div>\n  ",styles:[n("hO/x")]})],d);var h,u},TsxO:function(t,e){t.exports='<div id="container">\r\n  <div class="auto-complete-wrapper">\r\n    <input auto-complete id=\'search-bar\' placeholder=\'{{ searchText }}\' [source]="mrcList" min-chars="1"\r\n           no-match-found-text="Aucune entrée trouvée" max-num-list="10" [(ngModel)]="searchName" (ngModelChange)="searchNameChanged()"/>\r\n  </div>\r\n  <div #map class=\'map\'></div>\r\n</div>\r\n'},X3MM:function(t,e,n){"use strict";var i=n("3j3K");n.d(e,"a",function(){return o});var r=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},o=function(){function t(){}return t}();o=r([n.i(i.Component)({selector:"nav-bar",template:n("n0n0"),styles:[n("yTh5")]})],o)},YWx4:function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw"),o=n("0fHH");n.n(o);n.d(e,"a",function(){return s});var a=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},s=function(){function t(){var t=this;this.options=new o.MnFullpageOptions({scrollingSpeed:1e3,menu:".navigation",css3:!0,anchors:["home","stats","when","where","who","final"],onLeave:function(e,n){t.currentIndex=n}})}return t}();s=a([n.i(i.Component)({selector:"app-root",template:'\n    <loading-view></loading-view>\n    <nav-bar></nav-bar>\n    <div [mnFullpage]="options"\n    [mnFullpageKeyboardScrolling]="true"\n    [mnFullpageControlArrows]="false">\n      <div class="section fp-section">\n        <home-view></home-view>\n      </div>\n      <div class="section fp-section">\n        <stats-view></stats-view>\n      </div>\n      <div class="section fp-section">\n        <when-view></when-view>\n      </div>\n      <div class="section fp-section">\n        <where-view></where-view>\n      </div>\n      <div class="section fp-section">\n        <who-view></who-view>\n      </div>\n      <div class="section fp-section">\n        <final-view></final-view>\n      </div>\n    </div>\n    <filters-panel [currentIndex]="currentIndex"></filters-panel>\n  ',providers:[r.a]})],s)},Ybm7:function(t,e,n){"use strict";var i=n("3j3K"),r=n("ErHN"),o=n("Za4h"),a=(n.n(o),n("8hZP")),s=(n.n(a),n("M4fF")),c=(n.n(s),n("l6W8"));n.d(e,"a",function(){return h});var l=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},d=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=u=function(){function t(){this.isInitialized=!1,this.svgMargin={top:20,right:50,bottom:100,left:0},this.imgSize={x:30,y:30},this.imgSizeLegend={x:15,y:15},this.imgMargin={top:5,right:3,bottom:5,left:3},this.nbImages={x:10,y:10}}return t.lrm=function(t,e){var n=e-s.reduce(t,function(t,e){return t+Math.round(e)},0);return s(t).map(function(t,e){return{i:e,v:t}}).sortBy(function(t){return Math.round(t.v)-t.v}).map(function(e,i){return{i:e.i,v:Math.round(e.v)+(n>i?1:0)-(i>=t.length+n?1:0)}}).sortBy(function(t){return t.i}).map(function(t){return t.v}).value()},t.prototype.ngOnInit=function(){var t=this;if(this.dataset&&0!=this.dataset.length){var e=(this.imgSize.x+this.imgMargin.left+this.imgMargin.right)*this.nbImages.x,i=(this.imgSize.y+this.imgMargin.top+this.imgMargin.bottom)*this.nbImages.y,l=o.select(this.element.nativeElement),d=n.i(r.a)(l,e,i,this.svgMargin)[0];this.generateData(),this.color=o.scale.category10(),this.color.domain(s(10).range().map(function(t){return t.toString()}).value());var h=a().attr("class","d3-tip").offset([-10,0]).html(function(t){return t.name+" ("+t.proportions+"&nbsp;%)"});d.call(h),this.images=d.append("g").attr("transform","translate(60,0)"),this.images.selectAll("rect").data(this.data).enter().append("rect").attr({x:function(e,n){return n%t.nbImages.x*(t.imgSize.x+t.imgMargin.left+t.imgMargin.right)},y:function(e,n){return(t.imgSize.y+t.imgMargin.top+t.imgMargin.bottom)*Math.floor(n/t.nbImages.y)},width:this.imgSize.x,height:this.imgSize.y,fill:function(e){return t.color(e.id)}}).on("mouseover",function(t){c.a.call(this,t,h)}).on("mouseout",h.hide),this.legend=d.append("g").attr("class","gLegend"),this.generateLegend(),this.isInitialized=!0}},t.prototype.ngOnChanges=function(){var t=this;this.isInitialized&&(this.generateData(),this.images.selectAll("rect").data(this.data).transition().duration(1e3).attr("fill",function(e){return t.color(e.id)}),this.generateLegend())},t.prototype.generateData=function(){var t=s.sumBy(this.dataset,function(t){return t.totalAccidents}),e=u.lrm(s.map(this.dataset,function(e){return 100*e.totalAccidents/t}),100);this.sortedDataset=s(this.dataset).sortBy(function(t){return t.totalAccidents}).reverse().map(function(t){return t.proportions=e[t.id],t}).value(),this.data=s.flatMap(this.sortedDataset,function(t){return s.fill(Array(t.proportions),t)})},t.prototype.generateLegend=function(){var t=this;this.legend.html("");var e=this.legend.selectAll("g").data(this.sortedDataset).enter().append("g").filter(function(t){return 0!=t.proportions}).attr("id",function(t,e){return"who"+e});e.append("rect").attr({x:0,y:0,width:this.imgSizeLegend.x,height:this.imgSizeLegend.y,fill:function(e){return t.color(e.id)}}),e.append("text").text(function(t){return t.name}).attr({x:function(e,n){return t.imgSizeLegend.x+10},y:this.imgSizeLegend.y});var n=this.nbImages.y*(this.imgSize.y+this.imgMargin.top+this.imgMargin.bottom)+30;e.attr({transform:function(t,e){var i=0;return e>0&&s.range(e%5).forEach(function(t){var n=o.select("#who"+(t+5*Math.floor(e/5))),r=n.node().getBBox();i+=r.x+r.width+15}),5==e&&(n+=40),"translate("+i+", "+n+")"}})},t}();l([n.i(i.ViewChild)("imagegridcontainer"),d("design:type","function"==typeof(f=void 0!==i.ElementRef&&i.ElementRef)&&f||Object)],h.prototype,"element",void 0),l([n.i(i.Input)(),d("design:type",Array)],h.prototype,"dataset",void 0),h=u=l([n.i(i.Component)({selector:"imagegrid",template:'\n    <div #imagegridcontainer class="imagegrid-container"></div>\n  ',styles:["\n    :host .imagegrid-container {\n      width: 100%;\n      height: 100%;\n    }\n\n    :host /deep/ p {\n      text-align: center;\n    }\n  "]})],h);var u,f},fQyF:function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,".tab{height:100%;border:1px solid #404041}.tab>.tab-header{display:-webkit-box;display:-ms-flexbox;display:flex;box-sizing:border-box;width:100%;height:30px;line-height:30px;padding:0;margin:0;text-align:center;list-style:none;-ms-flex-wrap:wrap;flex-wrap:wrap}.tab>.tab-header>li{box-sizing:border-box;background-color:#f1f1f2;border-bottom:1px solid #404041;cursor:default;-webkit-box-flex:1;-ms-flex:1;flex:1}.tab>.tab-header>li:not(:last-child){border-right:1px solid #404041}.tab>.tab-header>li.active{color:#fff;background-color:#6d6e70}.tab>.tab-content{position:absolute;top:30px;left:0;right:0;bottom:0}",""]),t.exports=t.exports.toString()},"hO/x":function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,":host .container{width:100%;height:100%}:host /deep/ .axis{shape-rendering:crispEdges}:host /deep/ .axis line,:host /deep/ .axis path{fill:none;stroke:#000;shape-rendering:crispEdges}:host /deep/ .barchart .x.axis line{display:none}:host /deep/ .barchart .bar{fill:#445d77}:host /deep/ .title{font-size:13px;font-weight:700}:host .toggle-buttons{position:absolute;bottom:10px;right:10px;display:-webkit-box;display:-ms-flexbox;display:flex;box-sizing:border-box;width:400px;height:40px;color:#231f20;background-color:#f1f1f2;border:1px solid #404041;border-radius:4px;font-size:.85em;cursor:default;line-height:38px;-ms-flex-wrap:wrap;flex-wrap:wrap;z-index:10}:host .toggle-buttons>.toggle-button{-webkit-box-flex:1;-ms-flex:1;flex:1;width:100%}:host .toggle-buttons>.toggle-button:not(:last-child){border-right:1px solid #404041}:host .toggle-buttons>.toggle-button.active{color:#fff;background-color:#6d6e70}",""]),t.exports=t.exports.toString()},"i+t5":function(t,e,n){"use strict";var i=n("3j3K"),r=n("Za4h"),o=(n.n(r),n("8hZP")),a=(n.n(o),n("rJzN")),s=(n.n(a),n("l6W8"));n.d(e,"a",function(){return d});var c=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d=function(){function t(){this.isInitialized=!1}return t.prototype.ngOnInit=function(){var t=this,e=this.config.margin,n=this.config.width-e.left-e.right;this.height=this.config.height-e.top-e.bottom,this.g=r.select(this.element.nativeElement).append("svg").attr({class:"barchart",width:"100%",height:"100%",viewBox:"0 0 "+this.config.width+" "+this.config.height}),this.config.title&&this.g.append("text").text(this.config.title).attr({class:"title",x:this.config.width/2,"text-anchor":"middle"}),this.g=this.g.append("g").attr("transform","translate("+e.left+","+e.top+")"),this.xScale=r.scale.ordinal().rangeRoundBands([0,n],.1),this.yScale=r.scale.linear().range([this.height,0]),this.xAxis=r.svg.axis().scale(this.xScale).orient("bottom"),this.yAxis=r.svg.axis().scale(this.yScale).orient("left").tickFormat(r.format("d")),this.updateDomains();var i=o().attr("class","d3-tip").offset([-10,0]).html(function(t){return t.name+": "+t.value});this.g.call(i),this.g.append("g").attr("class","x axis").attr("transform","translate(0,"+this.height+")").call(this.xAxis).selectAll("text").data(this.config.dataset).text(function(t){return t.label}),this.g.append("g").attr("class","y axis").call(this.yAxis),this.g.selectAll("rect").data(this.config.dataset).enter().append("rect").attr({class:"bar",x:function(e){return t.xScale(e.id)},y:function(e){return t.yScale(e.value)},width:this.xScale.rangeBand(),height:function(e){return t.height-t.yScale(e.value)}}).on("mouseover",function(t){s.a.call(this,t,i)}).on("mouseout",i.hide),this.isInitialized=!0},t.prototype.ngOnChanges=function(){var t=this;if(this.isInitialized){var e=1e3;this.updateDomains(),this.g.selectAll(".y.axis").transition().duration(e).call(this.yAxis),this.g.selectAll("rect").data(this.config.dataset).transition().duration(e).attr({y:function(e){return t.yScale(e.value)},height:function(e){return t.height-t.yScale(e.value)}})}},t.prototype.updateDomains=function(){this.xScale.domain(this.config.dataset.map(function(t){return t.id})),this.yScale.domain([0,r.max(this.config.dataset,function(t){return t.value})])},t}();c([n.i(i.ViewChild)("container"),l("design:type","function"==typeof(h=void 0!==i.ElementRef&&i.ElementRef)&&h||Object)],d.prototype,"element",void 0),c([n.i(i.Input)(),l("design:type","function"==typeof(u=void 0!==a.BarChartConfig&&a.BarChartConfig)&&u||Object)],d.prototype,"config",void 0),d=c([n.i(i.Component)({selector:"barchart",template:"\n    <div #container class='container'></div>\n  ",styles:[n("hO/x")]})],d);var h,u},imtw:function(t,e,n){"use strict";var i=n("3j3K"),r=n("Fzro"),o=n("eErF"),a=(n.n(o),n("M4fF")),s=(n.n(a),n("Za4h")),c=(n.n(s),n("8JD7"));n.d(e,"c",function(){return h}),n.d(e,"b",function(){return u}),n.d(e,"a",function(){return f});var l=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},d=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],u=a.range(12),f=p=function(){function t(t,e){var n=this;this.http=t,this.quebecInfoService=e,this.onDataLoaded=new i.EventEmitter,this.onDataChanged=new i.EventEmitter,this.accidents=this.accidentsFiltered=this.loadData(),this.accidents.then(function(t){return console.log("Nombre d'entrées chargées: "+t.length)}),this.initializeData(),Promise.all([this.accidents,this.accidentsFiltered,this.accidentsPerDaysOfTheWeek,this.accidentsPerMonths,this.dailyAccidentsFiltered,this.hourlyAccidentsFiltered,this.accidentsByRAFiltered,this.accidentsByRegions,this.accidentsByEntityFiltered]).then(function(t){console.log("Données initialisées."),n.onDataLoaded.emit()})}return t.daysInMonth=function(t,e){return new Date(t,e,0).getDate()},t.prototype.applyFilters=function(t){var e=function(e){return!(void 0===e.entities.find(function(e,n){return e>0&&t.entities[n]})||-1!=t.criteria.zone&&t.criteria.zone!=e.zone||-1!=t.criteria.type&&t.criteria.type!=e.type||-1!=t.criteria.weather&&t.criteria.weather!=e.weather||-1!=t.criteria.gravity&&t.criteria.gravity!=e.gravity||-1!=t.location.region&&t.location.region!=e.regionCode||-1!=t.location.mrc&&t.location.mrc!=e.mrcCode)};this.accidentsFiltered=this.accidents.then(function(t){return t.filter(e)}),this.updateData(e),this.onDataChanged.emit()},t.prototype.initializeData=function(){this.hourlyAccidents=this.hourlyAccidentsFiltered=this.loadHourlyAccidents(),this.dailyAccidents=this.dailyAccidentsFiltered=this.loadDailyAccidents(this.hourlyAccidents),this.accidentsByRA=this.accidentsByRAFiltered=this.loadAccidentsByRA(),this.accidentsPerDaysOfTheWeek=this.loadAccidentsPerDaysOfTheWeek(),this.accidentsPerMonths=this.loadAccidentsPerMonths(),this.accidentsByRegions=this.loadAccidentByRegions(),this.accidentsByEntity=this.accidentsByEntityFiltered=this.loadAccidentByEntities()},t.prototype.updateData=function(t){this.accidentsPerDaysOfTheWeek=this.loadAccidentsPerDaysOfTheWeek(),this.accidentsPerMonths=this.loadAccidentsPerMonths(),this.dailyAccidentsFiltered=this.dailyAccidents.then(function(e){return a.map(e,function(e){var n=a.clone(e);return n.accidents=a.filter(e.accidents,t),n.val=n.accidents.length,n})}),this.hourlyAccidentsFiltered=this.hourlyAccidents.then(function(e){return a.map(e,function(e){var n=a.clone(e);return n.accidents=a.filter(e.accidents,t),n.val=n.accidents.length,n})}),this.accidentsByRAFiltered=this.accidentsByRA.then(function(e){return a.map(e,function(e){var n=a.clone(e);return n.accidents=a.filter(e.accidents,t),n.totalAccidents=n.accidents.length,n.mrcs=n.mrcs.map(function(e){var n=a.clone(e);return n.accidents=a.filter(e.accidents,t),n.totalAccidents=n.accidents.length,n}),n})}),this.accidentsByEntityFiltered=this.accidentsByEntity.then(function(e){return a.map(e,function(e){var n=a.clone(e);return n.accidents=a.filter(e.accidents,t),n.totalAccidents=a(n.accidents).map(function(t){return t.entities[e.id]}).sum(),n})}),this.accidentsByRegions=this.loadAccidentByRegions()},t.prototype.loadData=function(){var t="Non précisé",e=[["nb_bicyclette"],["nb_tous_autobus_minibus"],["nb_automobile_camion_leger"],["nb_urgence"],["nb_cyclomoteur","nb_motocyclette"],["NB_VICTIMES_PIETON"],["nb_motoneige","nb_VHR"],["nb_taxi"],["nb_camionLourd_tractRoutier","nb_outil_equipement"],["nb_autres_types","nb_veh_non_precise"]],n=[{id:0,types:[31]},{id:1,types:[32]},{id:2,types:[33]},{id:3,types:[34]},{id:4,types:[35,36,37]},{id:5,types:[40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,59]},{id:6,types:[71,72,73,74,75,99]},{id:7,types:[38,39,""]}],i=[{id:1,zones:[1]},{id:2,zones:[2]},{id:3,zones:[3]},{id:4,zones:[4]},{id:5,zones:[5]},{id:6,zones:[6]},{id:7,zones:[7]},{id:9,zones:[9,0,""]}];return this.http.get("assets/data/rapports-accident-reduit-2015.csv").toPromise().then(function(r){var o=r.text();return s.csv.parse(o,function(r){var o=s.time.format("%Y-%m-%d-%H"),a=r.heure_accdn.split(":")[0];r.DT_ACCDN=a===t?r.DT_ACCDN+"-00":r.DT_ACCDN+"-"+a;var c=o.parse(r.DT_ACCDN),l=/(.+)\s?\((\d+)\s*\)/,d=l.exec(r.REG_ADM),h=l.exec(r.MRC);return{month:c.getMonth(),day:c.getDate(),weekday:c.getDay(),hour:a===t?null:c.getHours(),gravity:+r.gravite,region:d[1],regionCode:+d[2],mrc:h[1],mrcCode:+h[2],weather:+r.CD_COND_METEO,type:n.find(function(t){return-1!=t.types.indexOf(r.CD_GENRE_ACCDN?+r.CD_GENRE_ACCDN:r.CD_GENRE_ACCDN)}).id,zone:i.find(function(t){return-1!=t.zones.indexOf(r.CD_ENVRN_ACCDN?+r.CD_ENVRN_ACCDN:r.CD_ENVRN_ACCDN)}).id,entities:e.map(function(t){return s.sum(t.map(function(t){return+r[t]}))}),dead:+r.NB_MORTS}})})},t.prototype.loadAccidentsPerDaysOfTheWeek=function(){var t=["D","L","M","M","J","V","S"],e=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],n=a.range(7).map(function(n){return{id:n,label:t[n],name:e[n],value:0}});return this.accidentsFiltered.then(function(i){return a(i).groupBy(function(t){return t.weekday}).toPairs().map(function(n){return{id:+n[0],label:t[+n[0]],name:e[+n[0]],value:+n[1].length}}).unionBy(n,"id").orderBy("id","asc").value()})},t.prototype.loadAccidentsPerMonths=function(){var t=["J","F","M","A","M","J","J","A","S","O","N","D"],e=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],n=a.range(12).map(function(n){return{id:n,label:t[n],name:e[n],value:0}});return this.accidentsFiltered.then(function(i){return a(i).groupBy(function(t){return t.month}).toPairs().map(function(n){return{id:+n[0],label:t[+n[0]],name:e[+n[0]],value:+n[1].length}}).unionBy(n,"id").orderBy("id","asc").value()})},t.prototype.loadDailyAccidents=function(t){return t.then(function(t){return a(t).groupBy(function(t){return t.month+"-"+t.day+"-"+t.weekday}).toPairs().map(function(t){var e=t[0].split("-");return{month:+e[0],day:+e[1],weekday:+e[2],val:a.reduce(t[1],function(t,e){return t+e.val},0),accidents:a(t[1]).map(function(t){return t.accidents}).flatten().value()}}).sortBy(["month","day"]).value()})},t.prototype.loadHourlyAccidents=function(){var t=a.range(12),e=a.range(24),n=a.flatMap(t,function(t){var n=a.range(1,p.daysInMonth(2015,t+1)+1);return a.flatMap(n,function(n){return a.map(e,function(e){return{month:t,day:n,hour:e,weekday:new Date(2015,t,n).getDay(),val:0,accidents:[]}})})});return this.accidentsFiltered.then(function(t){return a(t).filter(function(t){return null!=t.month&&null!=t.day&&null!=t.hour}).groupBy(function(t){var e=new Date(2015,t.month,t.day,t.hour);return e.getMonth()+"-"+e.getDate()+"-"+e.getDay()+"-"+e.getHours()}).toPairs().map(function(t){var e=t[0].split("-");return{month:+e[0],day:+e[1],weekday:+e[2],hour:+e[3],val:t[1].length,accidents:t[1]}}).unionBy(n,function(t){return t.month+"-"+t.day+"-"+t.hour}).sortBy(["month","day","hour"]).value()})},t.prototype.loadAccidentsByRA=function(){return Promise.all([this.accidentsFiltered,this.loadMRCPopulationData()]).then(function(t){return s.nest().key(function(t){return JSON.stringify({region:t.region,regionCode:t.regionCode})}).entries(t[0]).map(function(e){var n=JSON.parse(e.key),i=s.nest().key(function(t){return JSON.stringify({region:t.region,regionCode:t.regionCode,mrc:t.mrc,mrcCode:t.mrcCode})}).entries(e.values).map(function(e){var n=JSON.parse(e.key);return{code:n.mrcCode,name:n.mrc,population:a.find(t[1],function(t){return t.mrcCode===n.mrcCode}).population2015,totalAccidents:e.values.length,accidents:e.values}});return{code:n.regionCode,name:n.region,population:a(i).flatMap(function(t){return t.population}).sum(),totalAccidents:a(i).flatMap(function(t){return t.totalAccidents}).sum(),mrcs:a.flatten(i),accidents:e.values}})})},t.prototype.loadMRCPopulationData=function(){return this.http.get("assets/data/population_mrc.csv").toPromise().then(function(t){return s.csv.parse(t.text(),function(t){return{mrcCode:+t.CodeMRC,population2015:+t.Population2015}})})},t.prototype.loadAccidentByRegions=function(){var t=this.quebecInfoService.regions,e=a.range(17).map(function(e){return{id:e+1,label:t[e].name,name:t[e].name,value:0}});return this.accidentsFiltered.then(function(n){return a(n).groupBy(function(t){return t.regionCode}).toPairs().map(function(e){var n=t[+e[0]-1].name;return{id:+e[0],label:n,name:n,value:+e[1].length}}).unionBy(e,"id").orderBy("id","asc").value()})},t.prototype.loadAccidentByEntities=function(){var t=["Bicyclette","Autobus","Automobile","Véhicule d'urgence","Moto","Piéton","Véhicule récréatif","Taxi","Camion","Autres"];return this.accidentsFiltered.then(function(e){return a(e).map(function(t){return t.entities.map(function(e,n){return{id:n,totalAccidents:e,accident:t}})}).flatten().groupBy(function(t){return t.id}).toPairs().map(function(e){a.head(e);return{id:+e[0],name:t[+e[0]],totalAccidents:s.sum(e[1],function(t){return t.totalAccidents}),accidents:e[1].map(function(t){return t.accident})}}).value()})},t}();f=p=l([n.i(i.Injectable)(),d("design:paramtypes",["function"==typeof(g=void 0!==r.Http&&r.Http)&&g||Object,"function"==typeof(m=void 0!==c.a&&c.a)&&m||Object])],f);var p,g,m},kZql:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={production:!0}},l6W8:function(t,e,n){"use strict";function i(t,e){var n=Math.max(document.documentElement.clientHeight,window.innerHeight||0);e.show.call(this,t);for(var i=parseInt(e.style("top"),10);i>n;)i-=n+40;e.style("top",i+"px")}e.a=i},"n+f3":function(t,e){t.exports='<article class="reduced">\r\n  <div class="article-margin">\r\n    <h1>Qui ?</h1>\r\n    <p class="justify">\r\n      La majorité des accidents impliquent des automobilistes. En effet, cela représente environ 84&nbsp;% des accidents sur la route.\r\n    </p>\r\n    <div class="graphics-wrapper">\r\n      <imagegrid\r\n         *ngIf="entitiesAccidentDataset && !isDatasetEmpty"\r\n        [dataset]="entitiesAccidentDataset">\r\n      </imagegrid>\r\n      <h2 *ngIf="accidentsCount == 0">\r\n        Aucun accident trouvé\r\n      </h2>\r\n    </div>\r\n  </div>\r\n</article>\r\n'},n0n0:function(t,e){t.exports='<nav>\r\n  <ul class="navigation">\r\n    <li data-menuanchor="home">\r\n      <a href="#home">&bull;</a>\r\n    </li>\r\n    <li data-menuanchor="stats">\r\n      <a href="#stats">&bull;</a>\r\n    </li>\r\n    <li data-menuanchor="when">\r\n      <a href="#when">&bull;</a>\r\n    </li>\r\n    <li data-menuanchor="where">\r\n      <a href="#where">&bull;</a>\r\n    </li>\r\n    <li data-menuanchor="who">\r\n      <a href="#who">&bull;</a>\r\n    </li>\r\n    <li data-menuanchor="final">\r\n      <a href="#final">&bull;</a>\r\n    </li>\r\n  </ul>\r\n</nav>\r\n'},nUGs:function(t,e,n){"use strict";var i=n("3j3K");n.d(e,"a",function(){return o});var r=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},o=function(){function t(){}return t}();o=r([n.i(i.Component)({selector:"final-view",template:n("P2ad"),styles:[n("Ekwi")]})],o)},pOuB:function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,":host{position:fixed;top:45px;right:0;width:20%;background-color:#fff}:host form{position:relative;height:0;visibility:collapse;opacity:0;padding:10px;margin-right:30px;color:#231f20;font-size:.9em;-webkit-transition:opacity 1s,visibility 1s;transition:opacity 1s,visibility 1s}:host>.visible{height:100%;visibility:visible;opacity:1}:host fieldset{margin-bottom:10px;border:1px solid #bbbdc0;border-radius:4px}:host fieldset>legend{color:#6d6e71;font-size:.8em}:host select:not(:last-child){margin-bottom:4px}:host h1{margin-top:0;margin-bottom:10px;text-align:center;font-size:1.7em}:host small{font-size:medium}:host select{width:100%}@media only screen and (max-height:780px){:host form{font-size:.75em}}@media only screen and (max-height:680px){:host form{font-size:.6em}}",""]),t.exports=t.exports.toString()},pXPn:function(t,e,n){"use strict";var i=n("3j3K");n.d(e,"a",function(){return o});var r=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},o=function(){function t(){}return t}();o=r([n.i(i.Component)({selector:"home-view",template:n("0fTb"),styles:[n("OzaX")]})],o)},payn:function(t,e){t.exports='<article class="reduced">\r\n  <div class="article-margin">\r\n    <h1>Où ?</h1>\r\n    <p class="justify">\r\n      La plupart des accidents se sont produits dans la grande région de Montréal. En effet, cette région compte 17&nbsp;596 accidents pour l’année 2015.\r\n    </p>\r\n\r\n    <div class="graphics-wrapper">\r\n      <tabs>\r\n        <tab tabTitle="Carte des MRC">\r\n          <div class="map-wrapper">\r\n            <geomap *ngIf=\'mrcJson && geoMapConfig\' [json]="mrcJson" [config]="geoMapConfig" searchText="Rechercher une MRC..."></geomap>\r\n            <div class="toggle-buttons buttons-mrc">\r\n              <div class="toggle-button" [class.active]="mrcView == \'absolute\'" (click)="setMRCActiveView(\'absolute\')">Accidents totals</div>\r\n              <div class="toggle-button" [class.active]="mrcView == \'relative\'" (click)="setMRCActiveView(\'relative\')">Accidents / 10 000 habitants</div>\r\n            </div>\r\n          </div>\r\n        </tab>\r\n        <tab tabTitle="Régions administratives">\r\n          <horizontal-barchart *ngIf="barChartConfig" [config]="barChartConfig"></horizontal-barchart>\r\n          <div class="toggle-buttons buttons-ra">\r\n            <div class="toggle-button" [class.active]="view == \'absolute\'" (click)="setRAActiveView(\'absolute\')">Accidents totals</div>\r\n            <div class="toggle-button" [class.active]="view == \'relative\'" (click)="setRAActiveView(\'relative\')">Accidents / 10 000 habitants</div>\r\n          </div>\r\n        </tab>\r\n      </tabs>\r\n    </div>\r\n  </div>\r\n</article>\r\n'},rJzN:function(t,e){},tXfc:function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw"),o=n("H1TT"),a=n("M4fF");n.n(a);n.d(e,"a",function(){return l});var s=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(){function t(t,e){this.quebecMapService=t,this.accidentService=e,this.view="absolute",this.mrcView="absolute"}return t.prototype.ngOnInit=function(){this.initializeGraphics(),this.accidentService.onDataChanged.subscribe(this.initializeGraphics.bind(this))},t.prototype.initializeGraphics=function(){var t=this;this.quebecMapService.mrcJson.then(function(e){return t.mrcJson=e}),this.setMRCActiveView(this.mrcView),this.setRAActiveView(this.view)},t.prototype.setRAActiveView=function(t){var e=this;this.view=t,this.accidentService.accidentsByRAFiltered.then(function(n){var i=[];"absolute"===t?("Nombre d'accidents",i=a(n).map(function(t){return{id:t.code,label:t.name,name:t.name,value:t.totalAccidents}}).orderBy("id","asc").value()):"relative"===t&&("Nombre d'accidents par 10 000 habitants",i=a(n).map(function(t){return{id:t.code,label:t.name,name:t.name,value:Math.round(1e4*t.totalAccidents/t.population)}}).orderBy("id","asc").value()),e.barChartConfig={height:600,width:1e3,margin:{top:20,right:40,bottom:100,left:250},dataset:i}})},t.prototype.setMRCActiveView=function(t){var e=this;this.mrcView=t,this.accidentService.accidentsByRAFiltered.then(function(n){e.geoMapConfig={view:t,dataset:a.flatMap(n,function(t){return t.mrcs})}})},t}();l=s([n.i(i.Component)({selector:"where-view",template:n("payn"),styles:[n("/uoO")],providers:[o.a]}),c("design:paramtypes",["function"==typeof(d=void 0!==o.a&&o.a)&&d||Object,"function"==typeof(h=void 0!==r.a&&r.a)&&h||Object])],l);var d,h},u4sc:function(t,e){t.exports='<div class="tab">\r\n  <ul class="tab-header">\r\n    <li *ngFor="let tab of tabs" (click)="selectTab(tab)" [class.active]="tab.active">{{ tab.title }}</li>\r\n  </ul>\r\n  <div class="tab-content">\r\n    <ng-content></ng-content>\r\n  </div>\r\n</div>\r\n'},x35b:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("3j3K"),r=n("O61y"),o=n("Iksp");n("kZql").a.production&&n.i(i.enableProdMode)(),n.i(r.a)().bootstrapModule(o.a)},"xC+v":function(t,e,n){"use strict";var i=n("3j3K"),r=n("imtw"),o=n("Za4h");n.n(o);n.d(e,"a",function(){return c});var a=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},c=function(){function t(t){this.accidentService=t}return t.prototype.ngOnInit=function(){var t=this;this.accidentService.accidents.then(function(e){t.accidentsCount=e.length,t.fatalAccidentsCount=e.filter(function(t){return 3==t.gravity}).length,t.deadCount=o.sum(e.map(function(t){return t.dead}))})},t}();c=a([n.i(i.Component)({selector:"stats-view",template:n("6Jx0"),styles:[n("xuGd")]}),s("design:paramtypes",["function"==typeof(l=void 0!==r.a&&r.a)&&l||Object])],c);var l},xuGd:function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,":host{text-align:center}#accident{margin-top:50px;margin-bottom:20px;height:300px}p:not(.reference){font-size:1.6em}",""]),t.exports=t.exports.toString()},yTh5:function(t,e,n){e=t.exports=n("FZ+f")(),e.push([t.i,"nav{position:fixed;top:0;width:100%;height:38px;background-color:#58585b;border-bottom:2px solid #404041;text-align:center;z-index:10}nav>ul{position:relative;top:-4px;padding:0;margin:auto;list-style:none}nav>ul>li{display:inline-block;padding:0 8px;font-size:2.3em}nav>ul>li.active>a,nav>ul>li.active>a:active,nav>ul>li.active>a:hover,nav>ul>li.active>a:visited{color:#f1f1f2}nav>ul>li>a,nav>ul>li>a:active,nav>ul>li>a:hover,nav>ul>li>a:visited{color:#a7a9ab;text-decoration:none}",""]),t.exports=t.exports.toString()}},[0]);